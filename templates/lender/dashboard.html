{% extends "lender/layout.html" %}
{% block title %}Lender Dashboard{% endblock %}

{% block lender_content %}
<style>
  /* ============================================
     RESPONSIVE LAYOUT SYSTEM - MOBILE FIRST
     Matches Agent Dashboard Design
     ============================================ */
  
  .dashboard-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 1rem;
  }
  
  /* Header Section */
  .dashboard-header {
    padding: 1.5rem 1rem;
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.05) 0%, rgba(200, 180, 151, 0.05) 100%);
    border-radius: var(--border-radius-xl);
    margin-bottom: 2rem;
    text-align: center;
  }
  
  .dashboard-tagline {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--olive-green);
    font-weight: 600;
    margin-bottom: 0.5rem;
  }
  
  .dashboard-header h1 {
    font-family: var(--font-heading);
    font-size: 2rem;
    color: var(--charcoal-brown);
    margin-bottom: 0.75rem;
    font-weight: 600;
    letter-spacing: -0.02em;
  }
  
  .dashboard-header p {
    font-size: 1rem;
    color: var(--warm-gray);
    line-height: 1.6;
    max-width: 600px;
    margin: 0 auto;
  }
  
  /* Responsive Grid System */
  .responsive-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }
  
  /* Cards */
  .card {
    background: var(--soft-white);
    border: 1px solid rgba(200, 180, 151, 0.2);
    border-radius: var(--border-radius-xl);
    padding: 2rem;
    box-shadow: 0 2px 12px rgba(58, 53, 44, 0.06);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .card h2 {
    font-family: var(--font-heading);
    font-size: 1.5rem;
    color: var(--charcoal-brown);
    margin-bottom: 1.5rem;
    font-weight: 600;
    letter-spacing: -0.02em;
  }
  
  /* Metric Cards */
  .metrics-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    margin-bottom: 2rem;
  }
  
  .metric-card {
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.05) 0%, rgba(200, 180, 151, 0.08) 100%);
    border: 1px solid rgba(200, 180, 151, 0.2);
    border-radius: var(--border-radius-lg);
    padding: 1.5rem;
    text-align: center;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(107, 106, 69, 0.12);
    border-color: var(--olive-green);
  }
  
  .metric-value {
    font-size: 3rem;
    font-weight: 700;
    color: var(--olive-green);
    line-height: 1;
    margin-bottom: 0.5rem;
    font-family: var(--font-heading);
  }
  
  .metric-label {
    font-size: 0.9375rem;
    color: var(--charcoal-brown);
    font-weight: 600;
    margin-bottom: 0.25rem;
  }
  
  .metric-subtext {
    font-size: 0.8125rem;
    color: var(--warm-gray);
  }
  
  /* Quick Actions Grid */
  .actions-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .action-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.25rem;
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.03) 0%, rgba(200, 180, 151, 0.05) 100%);
    border: 1px solid rgba(200, 180, 151, 0.2);
    border-radius: var(--border-radius-lg);
    text-decoration: none;
    color: var(--charcoal-brown);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    min-height: 80px;
  }
  
  .action-card:hover {
    transform: translateX(4px);
    border-color: var(--olive-green);
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.08) 0%, rgba(200, 180, 151, 0.08) 100%);
    box-shadow: 0 4px 16px rgba(107, 106, 69, 0.12);
    text-decoration: none;
    color: var(--charcoal-brown);
  }
  
  .action-icon {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--olive-green) 0%, #5A5938 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    font-size: 1.5rem;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(107, 106, 69, 0.3);
  }
  
  .action-content {
    flex: 1;
  }
  
  .action-title {
    font-weight: 600;
    font-size: 1.0625rem;
    margin-bottom: 0.25rem;
    color: var(--charcoal-brown);
  }
  
  .action-desc {
    font-size: 0.875rem;
    color: var(--warm-gray);
    line-height: 1.5;
  }
  
  /* Loan List */
  .loan-item {
    display: block;
    padding: 1.25rem;
    margin-bottom: 0.75rem;
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.03) 0%, rgba(200, 180, 151, 0.05) 100%);
    border: 1px solid rgba(200, 180, 151, 0.2);
    border-radius: var(--border-radius-lg);
    text-decoration: none;
    color: var(--charcoal-brown);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    border-left: 4px solid var(--olive-green);
  }
  
  .loan-item:hover {
    transform: translateX(6px);
    border-color: var(--olive-green);
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.08) 0%, rgba(200, 180, 151, 0.08) 100%);
    box-shadow: 0 4px 16px rgba(107, 106, 69, 0.12);
  }
  
  .loan-name {
    font-weight: 600;
    font-size: 1.0625rem;
    color: var(--charcoal-brown);
    margin-bottom: 0.5rem;
  }
  
  .loan-details {
    font-size: 0.875rem;
    color: var(--warm-gray);
  }
  
  /* Empty State */
  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
    background: linear-gradient(135deg, rgba(107, 106, 69, 0.05) 0%, rgba(200, 180, 151, 0.08) 100%);
    border-radius: var(--border-radius-2xl);
    border: 1px solid rgba(200, 180, 151, 0.2);
  }
  
  .empty-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }
  
  .empty-state h3 {
    font-family: var(--font-heading);
    color: var(--charcoal-brown);
    font-size: 1.5rem;
    margin-bottom: 0.75rem;
  }
  
  .empty-state p {
    color: var(--warm-gray);
    line-height: 1.6;
  }
  
  /* Buttons */
  .btn-outline {
    display: inline-block;
    padding: 0.875rem 2rem;
    background: white;
    color: var(--olive-green);
    border: 2px solid var(--olive-green);
    border-radius: var(--border-radius-full);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9375rem;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    text-align: center;
    letter-spacing: 0.02em;
  }
  
  .btn-outline:hover {
    background: var(--olive-green);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(107, 106, 69, 0.3);
  }
  
  .btn-primary {
    display: inline-block;
    padding: 0.875rem 2rem;
    background: linear-gradient(135deg, var(--olive-green) 0%, #5A5938 100%);
    color: white;
    border: none;
    border-radius: var(--border-radius-full);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9375rem;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    text-align: center;
    letter-spacing: 0.02em;
    box-shadow: 0 4px 15px rgba(107, 106, 69, 0.3);
  }
  
  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(107, 106, 69, 0.4);
  }
  
  /* ============================================
     TABLET BREAKPOINT (768px+)
     ============================================ */
  @media (min-width: 768px) {
    .dashboard-container {
      padding: 2rem;
    }
    
    .dashboard-header {
      padding: 2.5rem 2rem;
      text-align: left;
    }
    
    .dashboard-header h1 {
      font-size: 2.5rem;
    }
    
    .dashboard-header p {
      max-width: none;
      margin: 0;
    }
    
    /* Metrics: 2 columns on tablet */
    .metrics-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.25rem;
    }
    
    /* Actions: 2 columns on tablet */
    .actions-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.25rem;
    }
  }
  
  /* ============================================
     DESKTOP BREAKPOINT (1024px+)
     ============================================ */
  @media (min-width: 1024px) {
    .dashboard-container {
      padding: 3rem 2rem;
    }
    
    .dashboard-header {
      padding: 3rem 2.5rem;
    }
    
    .dashboard-header h1 {
      font-size: 3rem;
    }
    
    /* Metrics: 3 columns on desktop */
    .metrics-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
    }
    
    /* Two-column layout for main content */
    .responsive-grid {
      grid-template-columns: 2fr 1fr;
      gap: 2rem;
    }
    
    /* Actions: 2 columns on desktop */
    .actions-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }
    
    .metric-card {
      padding: 2rem;
    }
    
    .metric-value {
      font-size: 3.5rem;
    }
  }
  
  /* ============================================
     LARGE DESKTOP BREAKPOINT (1280px+)
     ============================================ */
  @media (min-width: 1280px) {
    /* Actions: Full width cards on large desktop */
    .actions-grid {
      grid-template-columns: 1fr;
    }
  }
  
  /* ============================================
     MOBILE OPTIMIZATIONS (Portrait Mode)
     ============================================ */
  @media (max-width: 767px) and (orientation: portrait) {
    .dashboard-container {
      padding: 1rem 0.875rem;
    }
    
    .dashboard-header {
      padding: 1.25rem 1rem;
      margin-bottom: 1.5rem;
    }
    
    .dashboard-header h1 {
      font-size: 1.75rem;
    }
    
    .dashboard-header p {
      font-size: 0.9375rem;
    }
    
    .card {
      padding: 1.5rem 1rem;
    }
    
    .card h2 {
      font-size: 1.25rem;
      margin-bottom: 1.25rem;
    }
    
    .metric-card {
      padding: 1.25rem 1rem;
    }
    
    .metric-value {
      font-size: 2.5rem;
    }
    
    .action-card {
      padding: 1rem;
      min-height: auto;
    }
    
    .action-icon {
      width: 48px;
      height: 48px;
      font-size: 1.25rem;
    }
    
    .action-title {
      font-size: 1rem;
    }
    
    .action-desc {
      font-size: 0.8125rem;
    }
    
    .btn-outline, .btn-primary {
      width: 100%;
      padding: 1rem 1.5rem;
      min-height: 48px;
    }
    
    .loan-item {
      padding: 1rem;
    }
    
    .loan-name {
      font-size: 1rem;
    }
    
    .loan-details {
      font-size: 0.8125rem;
    }
    
    .empty-state {
      padding: 3rem 1.5rem;
    }
    
    .empty-state h3 {
      font-size: 1.25rem;
    }
  }
  
  /* Animation */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-in {
    animation: fadeIn 0.5s ease-out;
  }
</style>

<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header animate-in">
    <p class="dashboard-tagline">Your command center</p>
    <h1>Lender Dashboard</h1>
    <p>A warm, clear view of borrowers, files, and growth tools.</p>
  </div>
  
  <!-- Metrics Cards -->
  <div class="metrics-grid">
    <div class="metric-card">
      <div class="metric-value">{{ metrics.new_applications|default(0) }}</div>
      <div class="metric-label">New Applications</div>
      <div class="metric-subtext">Started the process</div>
    </div>
    
    <div class="metric-card">
      <div class="metric-value">{{ metrics.loans_in_process|default(0) }}</div>
      <div class="metric-label">Loans in Process</div>
      <div class="metric-subtext">Moving through pipeline</div>
    </div>
    
    <div class="metric-card">
      <div class="metric-value">{{ metrics.nurture_contacts|default(0) }}</div>
      <div class="metric-label">Nurture Contacts</div>
      <div class="metric-subtext">Past clients & leads</div>
    </div>
  </div>
  
  <!-- Responsive Grid Layout (Desktop: 2 columns, Mobile: Stacked) -->
  <div class="responsive-grid">
    <!-- Left Column: Active Loans -->
    <div>
      {% if loans and loans|length > 0 %}
      <div class="card">
        <h2>Active Loans</h2>
        {% for loan in loans[:5] %}
        <div class="loan-item">
          <div class="loan-name">{{ loan.borrower_name or 'Borrower' }}</div>
          <div class="loan-details">
            {{ loan.loan_type|title if loan.loan_type else 'Loan' }} • 
            {{ loan.status|title if loan.status else 'Active' }}
            {% if loan.loan_amount %}
            • ${{ "{:,.0f}".format(loan.loan_amount) }}
            {% endif %}
          </div>
        </div>
        {% endfor %}
        <div style="margin-top: 1.5rem;">
          <a href="{{ url_for('lender_loans') }}" class="btn-outline">View All Loans</a>
        </div>
      </div>
      {% else %}
      <div class="card">
        <h2>Active Loans</h2>
        <div class="empty-state">
          <div class="empty-icon" style="width: 80px; height: 80px; margin: 0 auto 1rem; background: linear-gradient(135deg, rgba(107, 106, 69, 0.1) 0%, rgba(200, 180, 151, 0.1) 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--olive-green);">—</div>
          <h3>No Active Loans</h3>
          <p>Start tracking loans to see them here</p>
          <a href="{{ url_for('lender_loans') }}" class="btn-primary" style="margin-top: 1.5rem;">Add Your First Loan</a>
        </div>
      </div>
      {% endif %}
    </div>
    
    <!-- Right Column: Quick Actions -->
    <div>
      <div class="card">
        <h2>Quick Actions</h2>
        <div class="actions-grid">
          <a href="{{ url_for('lender_crm') }}" class="action-card">
            <div class="action-icon">+</div>
            <div class="action-content">
              <div class="action-title">Add Borrower</div>
              <div class="action-desc">Add to your borrower list</div>
            </div>
          </a>
          
          <a href="{{ url_for('lender_loans') }}" class="action-card">
            <div class="action-icon">◉</div>
            <div class="action-content">
              <div class="action-title">Add New Loan</div>
              <div class="action-desc">Start tracking a new file</div>
            </div>
          </a>
          
          <a href="{{ url_for('lender_messages') }}" class="action-card">
            <div class="action-icon">@</div>
            <div class="action-content">
              <div class="action-title">Messages</div>
              <div class="action-desc">Communicate with borrowers</div>
            </div>
          </a>
          
          <a href="{{ url_for('lender_marketing') }}" class="action-card">
            <div class="action-icon">✎</div>
            <div class="action-content">
              <div class="action-title">Marketing Tools</div>
              <div class="action-desc">Create marketing materials</div>
            </div>
          </a>
          
          <a href="{{ url_for('lender_calculator') }}" class="action-card">
            <div class="action-icon">%</div>
            <div class="action-content">
              <div class="action-title">Rate Calculator</div>
              <div class="action-desc">Calculate loan payments</div>
            </div>
          </a>
          
          <a href="{{ url_for('lender_settings_profile') }}" class="action-card">
            <div class="action-icon">⚙</div>
            <div class="action-content">
              <div class="action-title">Settings</div>
              <div class="action-desc">Update your profile</div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
