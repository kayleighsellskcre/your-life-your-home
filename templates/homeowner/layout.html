{# templates/homeowner/layout.html #}
{% extends "base.html" %}

{% block page_title %}Dashboard • Your Life Your Home{% endblock %}

{% block content %}
<style>
  /* Integrated Header + Dashboard Navigation */
  .ylh-horizontal-nav {
    background: linear-gradient(135deg, #F6F2E8 0%, #EFE9DC 100%);
    border-bottom: 3px solid rgba(107, 106, 69, 0.2);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    position: sticky;
    top: 5rem;
    z-index: 999;
  }
  
  .ylh-nav-container {
    max-width: 1600px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 2rem;
    height: 60px;
  }
  
  .ylh-nav-title {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: 1.5rem;
    color: #6B6A45;
    font-weight: 400;
    letter-spacing: 0.02em;
    margin: 0 0 0 5rem;
    white-space: nowrap;
  }
  
  .ylh-nav-items {
    display: flex;
    align-items: center;
    gap: 0;
    flex: 1;
    justify-content: flex-end;
    margin-right: 1rem;
    overflow: visible;
    position: relative;
  }
  
  .ylh-nav-items::-webkit-scrollbar {
    display: none;
  }
  
  .ylh-nav-button {
    background: transparent;
    border: none;
    color: #6B6A45;
    padding: 0.75rem 1.5rem;
    font-size: 0.8rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    border-bottom: 3px solid transparent;
    position: relative;
    min-height: 44px;
    display: flex;
    align-items: center;
  }
  
  .ylh-nav-button:hover {
    background: rgba(107, 106, 69, 0.1);
    color: #3A352C;
    border-bottom-color: rgba(107, 106, 69, 0.5);
  }
  
  .ylh-nav-button.active {
    background: rgba(107, 106, 69, 0.15);
    color: #3A352C;
    border-bottom-color: #6B6A45;
    font-weight: 600;
  }
  
  .ylh-nav-link {
    color: #6B6A45;
    padding: 0.75rem 1.5rem;
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    text-decoration: none;
    transition: all 0.3s ease;
    white-space: nowrap;
    border-bottom: 3px solid transparent;
    display: inline-block;
  }
  
  .ylh-nav-link:hover {
    background: rgba(107, 106, 69, 0.1);
    color: #3A352C;
    border-bottom-color: rgba(107, 106, 69, 0.5);
  }
  
  .ylh-nav-link.active {
    background: rgba(107, 106, 69, 0.15);
    color: #3A352C;
    border-bottom-color: #6B6A45;
    font-weight: 600;
  }
  
  .ylh-dropdown {
    position: relative;
  }
  
  .ylh-dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    min-width: 280px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    border-top: 3px solid #6B6A45;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    z-index: 9999;
    max-height: 80vh;
    overflow-y: auto;
  }
  
  .ylh-dropdown.is-open .ylh-dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  @keyframes dropdownSlide {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .ylh-dropdown-item {
    display: block;
    padding: 1rem 1.5rem;
    color: #3A352C;
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 400;
    transition: all 0.2s ease;
    border-left: 3px solid transparent;
    min-height: 48px;
    display: flex;
    align-items: center;
  }
  
  .ylh-dropdown-item:hover {
    background: #F6F2E8;
    border-left-color: #C8B497;
    padding-left: 1.75rem;
  }
  
  .ylh-dropdown-item.active {
    background: #EFE9DC;
    color: #6B6A45;
    font-weight: 500;
    border-left-color: #6B6A45;
  }
  
  @media (max-width: 768px) {
    .ylh-nav-container {
      padding: 0 1rem;
      flex-direction: column;
      height: auto;
      gap: 0.5rem;
    }
    
    .ylh-nav-title {
      font-size: 1.8rem;
      margin: 1rem 0 0.5rem 0;
    }
    
    .ylh-nav-items {
      width: 100%;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.25rem;
    }
    
    .ylh-nav-button,
    .ylh-nav-link {
      padding: 1rem 1.25rem;
      font-size: 0.9rem;
      letter-spacing: 0.05em;
      min-height: 48px;
    }
    
    .ylh-dropdown-menu {
      min-width: 100%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1rem;
    }
    
    .ylh-dropdown-item {
      padding: 1.25rem 1.5rem;
      font-size: 1rem;
      min-height: 52px;
    }
  }
</style>

  {% set path = request.path or '' %}

  {# Figure out which section is active based on the current URL #}
  {% set is_home_base = path.startswith('/homeowner/overview') or path.startswith('/homeowner/upload-documents') %}
  {% set is_value = path.startswith('/homeowner/value/') %}
  {% set is_reno = path.startswith('/homeowner/reno/') or path.startswith('/homeowner/saved-notes') or path.startswith('/homeowner/design-boards') %}
  {% set is_next = path.startswith('/homeowner/next/') %}
  {% set is_care = path.startswith('/homeowner/care/') %}
  {% set is_support = path.startswith('/homeowner/support/') %}

  <!-- Horizontal Navigation Bar -->
  <nav class="ylh-horizontal-nav">
    <div class="ylh-nav-container">
      <h1 class="ylh-nav-title">Dashboard</h1>
      
      <div class="ylh-nav-items">
        <!-- Home Base Dropdown -->
        <div class="ylh-dropdown">
          <button type="button" class="ylh-nav-button {% if is_home_base %}active{% endif %}" onclick="toggleDropdown(this, event)">
            Home Base ▾
          </button>
          <div class="ylh-dropdown-menu">
            <a href="{{ url_for('homeowner_overview') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/overview') %}active{% endif %}">
              Dashboard Overview
            </a>
            <a href="{{ url_for('homeowner_upload_documents') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/upload-documents') %}active{% endif %}">
              Upload Documents
            </a>
          </div>
        </div>
        
        <!-- Value & Equity Dropdown -->
        <div class="ylh-dropdown">
          <button type="button" class="ylh-nav-button {% if is_value %}active{% endif %}" onclick="toggleDropdown(this, event)">
            Value & Equity ▾
          </button>
          <div class="ylh-dropdown-menu">
            <a href="{{ url_for('homeowner_value_my_home') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/value/my-home') %}active{% endif %}">
              My Home Value
            </a>
            <a href="{{ url_for('homeowner_value_equity_overview') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/value/equity-overview') %}active{% endif %}">
              Equity Overview
            </a>
          </div>
        </div>
        
        <!-- Renovation & Improvement Dropdown -->
        <div class="ylh-dropdown">
          <button type="button" class="ylh-nav-button {% if is_reno %}active{% endif %}" onclick="toggleDropdown(this, event)">
            Renovation ▾
          </button>
          <div class="ylh-dropdown-menu">
            <a href="{{ url_for('homeowner_saved_notes') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/saved-notes') or path.startswith('/homeowner/design-boards') %}active{% endif %}">
              Mood Board & Planner
            </a>
            <a href="{{ url_for('homeowner_reno_design_ideas') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/reno/design-ideas') %}active{% endif %}">
              Design Ideas
            </a>
            <a href="{{ url_for('homeowner_reno_material_cost') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/reno/material-cost') %}active{% endif %}">
              Cost Estimator
            </a>
            <a href="{{ url_for('homeowner_reno_roi_guide') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/reno/roi-guide') %}active{% endif %}">
              ROI Guide
            </a>
            <a href="{{ url_for('homeowner_reno_before_after') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/reno/before-after') %}active{% endif %}">
              Before & After
            </a>
          </div>
        </div>
        
        <!-- Next Home Strategy Dropdown -->
        <div class="ylh-dropdown">
          <button type="button" class="ylh-nav-button {% if is_next %}active{% endif %}" onclick="toggleDropdown(this, event)">
            Next Home ▾
          </button>
          <div class="ylh-dropdown-menu">
            <a href="{{ url_for('homeowner_next_plan_move') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/next/plan-my-move') %}active{% endif %}">
              Plan My Move
            </a>
            <a href="{{ url_for('homeowner_next_buy_sell_guidance') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/next/buy-sell-guidance') %}active{% endif %}">
              Buy & Sell Guidance
            </a>
            <a href="{{ url_for('homeowner_next_pathways') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/next/pathways') %}active{% endif %}">
              Next-Home Pathways
            </a>
            <a href="{{ url_for('homeowner_next_loan_paths') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/next/loan-paths') %}active{% endif %}">
              Loan Paths
            </a>
            <a href="{{ url_for('homeowner_next_affordability') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/next/affordability') %}active{% endif %}">
              Affordability
            </a>
          </div>
        </div>
        
        <!-- Ownership Care Dropdown -->
        <div class="ylh-dropdown">
          <button type="button" class="ylh-nav-button {% if is_care %}active{% endif %}" onclick="toggleDropdown(this, event)">
            Care ▾
          </button>
          <div class="ylh-dropdown-menu">
            <a href="{{ url_for('homeowner_upload_documents') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/upload-documents') or path.startswith('/homeowner/home-timeline') %}active{% endif %}">
              Documents & Timeline
            </a>
            <a href="{{ url_for('homeowner_care_maintenance_guide') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/care/maintenance-guide') %}active{% endif %}">
              Maintenance Guide
            </a>
            <a href="{{ url_for('homeowner_care_seasonal_checklists') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/care/seasonal-checklists') %}active{% endif %}">
              Seasonal Checklists
            </a>
            <a href="{{ url_for('homeowner_care_home_protection') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/care/home-protection') %}active{% endif %}">
              Home Protection
            </a>
            <a href="{{ url_for('homeowner_care_warranty_log') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/care/warranty-log') %}active{% endif %}">
              Warranty Log
            </a>
            <a href="{{ url_for('homeowner_care_energy_savings') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/care/energy-savings') %}active{% endif %}">
              Energy Savings
            </a>
          </div>
        </div>
        
        <!-- Support Dropdown -->
        <div class="ylh-dropdown">
          <button type="button" class="ylh-nav-button {% if is_support %}active{% endif %}" onclick="toggleDropdown(this, event)">
            Support ▾
          </button>
          <div class="ylh-dropdown-menu">
            <a href="{{ url_for('homeowner_support_ask_question') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/support/ask-question') %}active{% endif %}">
              Ask a Question
            </a>
            <a href="{{ url_for('homeowner_support_chat_human') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/support/chat-human') %}active{% endif %}">
              Chat with Human
            </a>
            <a href="{{ url_for('homeowner_support_schedule_chat') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/support/schedule-chat') %}active{% endif %}">
              Schedule Chat
            </a>
            <a href="{{ url_for('homeowner_support_resources') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/support/resources') %}active{% endif %}">
              Resources
            </a>
            <a href="{{ url_for('homeowner_support_meet_team') }}" class="ylh-dropdown-item {% if path.startswith('/homeowner/support/meet-team') %}active{% endif %}">
              Meet Team
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div style="max-width: 1600px; margin: 0 auto; padding: 3rem 4rem;">
    <!-- Main content area -->
    <section>
      {% block homeowner_content %}{% endblock %}
    </section>
  </div>

<script>
function toggleDropdown(btn, evt) {
  evt.stopPropagation();
  evt.preventDefault();
  
  var dropdown = btn.parentElement;
  var isOpen = dropdown.classList.contains('is-open');
  
  // Close all dropdowns
  var allDropdowns = document.querySelectorAll('.ylh-dropdown');
  for (var i = 0; i < allDropdowns.length; i++) {
    allDropdowns[i].classList.remove('is-open');
  }
  
  // Toggle this one
  if (!isOpen) {
    dropdown.classList.add('is-open');
  }
}

// Close when clicking outside
document.addEventListener('click', function() {
  var allDropdowns = document.querySelectorAll('.ylh-dropdown');
  for (var i = 0; i < allDropdowns.length; i++) {
    allDropdowns[i].classList.remove('is-open');
  }
});
</script>
{% endblock %}
