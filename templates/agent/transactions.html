{% extends "agent/layout.html" %}


{% block agent_content %}
<div class="dashboard-main__header animated fadeInDown">
  <p class="dashboard-tagline">ğŸš€ Track every deal with ease</p>
  <h1 style="font-size:2.5rem;letter-spacing:0.02em;">AI Transaction Coordinator</h1>
  <p style="font-size:1.1rem;color:#6b6b6b;">All your files, stages, and clients in one beautiful, interactive dashboard.</p>
</div>

  <div class="card form-card animated fadeInUp" style="box-shadow:0 4px 24px rgba(0,0,0,0.07);">
    <h2 style="margin-bottom:1rem;">Add a Transaction</h2>
    <form method="post" class="transaction-form">
      <div class="form-row">
        <label for="property_address">ğŸ  Property Address</label>
        <input id="property_address" name="property_address" required placeholder="123 Main St" />
      </div>
      <div class="form-row">
        <label for="client_name">ğŸ‘¤ Client Name</label>
        <input id="client_name" name="client_name" required placeholder="Jane Doe" />
      </div>
      <div class="form-row">
        <label for="side">ğŸ¤ Side</label>
        <select id="side" name="side">
          <option value="buyer">Buyer</option>
          <option value="seller">Seller</option>
          <option value="both">Both</option>
        </select>
      </div>
      <div class="form-row">
        <label for="stage">ğŸ“ˆ Stage</label>
        <select id="stage" name="stage">
          <option value="summary">Summary</option>
          <option value="showings">Showings</option>
          <option value="under_contract">Under Contract</option>
          <option value="earnest_money">Earnest Money</option>
          <option value="inspection">Inspection</option>
          <option value="appraisal">Appraisal</option>
          <option value="loan_commitment">Loan Commitment</option>
          <option value="final_walkthrough">Final Walkthrough</option>
          <option value="closing">Closing</option>
        </select>
      </div>
      <div class="form-row">
        <label for="close_date">ğŸ“… Target Close Date</label>
        <input type="date" id="close_date" name="close_date" />
      </div>
      <button class="btn btn-primary" type="submit" style="margin-top:1.5rem;transition:box-shadow 0.2s;box-shadow:0 2px 8px rgba(0,0,0,0.08);">ğŸš€ Start Transaction</button>
    </form>
  </div>

  <div class="card animated fadeIn" style="margin-top:2rem;box-shadow:0 4px 24px rgba(0,0,0,0.07);">
    <h2 style="margin-bottom:1rem;">Your Files</h2>

    {% if transactions %}
      <div style="overflow-x:auto;margin-top:1.5rem;">
        <table class="data-table" style="animation:fadeIn 0.7s;">
          <thead>
            <tr>
              <th>ğŸ  Property</th>
              <th>ğŸ‘¤ Client</th>
              <th>ğŸ¤ Side</th>
              <th>ğŸ“ˆ Stage</th>
              <th>ğŸ“… Close Date</th>
              <th>âš¡ Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for tx in transactions %}
              <tr class="transaction-row clickable-row" data-href="{{ url_for('agent_transaction_detail', tx_id=tx.id) }}" style="transition:background 0.2s; cursor:pointer;">
                <td>
                  <span class="property-link" style="color:var(--olive-green);font-weight:600;text-decoration:none;transition:color 0.2s;">
                    {{ tx.property_address }}
                  </span>
                </td>
                <td>{{ tx.client_name }}</td>
                <td><span class="badge" style="background:var(--light-cream);color:var(--charcoal-brown);padding:0.25rem 0.75rem;border-radius:12px;font-size:0.8rem;font-weight:600;">{{ tx.side|capitalize }}</span></td>
                <td><span style="color:#888;">{{ tx.stage|replace('_',' ')|title }}</span></td>
                <td style="color:#888;">{{ tx.close_date or 'â€”' }}</td>
                <td style="white-space:nowrap;">
                  <form method="POST" action="{{ url_for('agent_transaction_delete', tx_id=tx.id) }}" style="display:inline;" onclick="event.stopPropagation();">
                    <button type="submit" class="btn btn-danger btn-sm" style="transition:box-shadow 0.2s;" onclick="return confirm('Delete this transaction? This cannot be undone.')">Delete</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="empty-state animated fadeInUp">
        <div style="font-size:3rem;margin-bottom:1rem;">ğŸ“‹</div>
        <h3>No Transactions Yet</h3>
        <p>Once you add a file, you will be able to track stages here.</p>
      </div>
    {% endif %}
  </div>
</div>

<script>
// Make transaction rows clickable
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.clickable-row').forEach(function(row) {
    row.addEventListener('click', function() {
      window.location = this.dataset.href;
    });
  });
});
</script>
<style>
.animated { animation-duration: 0.7s; animation-fill-mode: both; }
.fadeIn { animation-name: fadeIn; }
.fadeInUp { animation-name: fadeInUp; }
.fadeInDown { animation-name: fadeInDown; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: none; } }
@keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: none; } }
.form-card { border-radius: 16px; padding: 2rem 2.5rem; background: #fff; }
.transaction-form .form-row { display: flex; flex-direction: column; margin-bottom: 1rem; }
.transaction-form label { font-size: 1rem; font-weight: 600; color: var(--olive-green); margin-bottom: 0.5rem; }
.transaction-form input, .transaction-form select { padding: 0.7rem 1rem; border-radius: 8px; border: 1px solid #d3d3c3; font-size: 1rem; transition: border 0.2s; }
.transaction-form input:focus, .transaction-form select:focus { border-color: var(--olive-green); outline: none; }
.property-link:hover { color: #b2a97b; text-decoration:underline; }
.transaction-row:hover { background: #f7f7e9; }
.btn-primary { background: var(--olive-green); color: #fff; font-weight: 700; border: none; border-radius: 8px; padding: 1rem; font-size: 1.1rem; cursor: pointer; }
.btn-primary:hover { box-shadow: 0 4px 16px rgba(178,169,123,0.15); }
.btn-danger { background: #c0392b; color: #fff; border: none; border-radius: 8px; padding: 0.5rem 1rem; font-size: 0.95rem; cursor: pointer; }
.btn-danger:hover { box-shadow: 0 2px 8px rgba(192,57,43,0.15); }
.badge { font-size: 0.9rem; }
</style>

{% endblock %}
